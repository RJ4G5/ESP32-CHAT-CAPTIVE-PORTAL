<!doctype html><html lang="pt-BR"><head><title>ESP32 Chat</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta charset="UTF-8"><style type="text/css">body{background-color:#f0f0f0;font-family:Arial,sans-serif;margin:0;padding:0}.loading-message{font-weight:700;padding:20px;text-align:center}.progress-container{background-color:#ddd;border-radius:10px;height:20px;margin:20px auto;overflow:hidden;width:80%}.progress-bar{background-color:#4caf50;height:100%;transition:width .3s ease;width:0}</style></head><body><div id="app-container"><div class="loading-message">Carregando aplicação...</div><div class="progress-container"><div id="progress-bar" class="progress-bar"></div></div></div><script defer="defer">(()=>{var t={913:(t,e,r)=>{"use strict";r.r(e)}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(913);class n{constructor(){this.loadedFragmentsCount=0,this.fragmentsContent=[],this.totalFragments=0}async loadIndexFile(){try{const t=await fetch("fragments/index.txt");if(!t.ok)throw new Error(`Falha ao carregar index: ${t.status}`);const e=await t.text();return this.parseIndexData(e)}catch(t){return null}}parseIndexData(t){const e={};return t.split("\n").filter((t=>t.trim())).forEach((t=>{const[r,n]=t.split(":").map((t=>t.trim()));e[r]="fragments"===r||"filesize"===r?Number(n):n})),this.totalFragments=e.fragments,this.fragmentsContent=new Array(this.totalFragments).fill(""),e}updateProgressBar(){const t=this.loadedFragmentsCount/this.totalFragments*100;document.getElementById("progress-bar").style.width=`${t}%`}async fetchFragment(t){const e=new AbortController,r=setTimeout((()=>e.abort()),5e3);try{const n=await fetch(`/fragments/fragment_${t}`,{signal:e.signal});if(clearTimeout(r),!n.ok)throw new Error(`Erro no fragmento ${t}: ${n.status}`);const a=await n.text();return this.fragmentsContent[t]=a,this.loadedFragmentsCount++,this.updateProgressBar(),!0}catch(e){return await this.delay(1e3),this.fetchFragment(t)}}delay(t){return new Promise((e=>setTimeout(e,t)))}assembleContent(){const t=document.getElementById("app-container");document.querySelector(".loading-message").textContent="Iniciando o sistema...";try{const e=this.fragmentsContent.join(""),r=(new DOMParser).parseFromString(e,"text/html");if(!r.body)throw new Error("Falha ao parsear HTML");t.innerHTML="",this.appendStyles(r),this.appendBodyContent(r,t),this.appendScripts(r),this.forceLayoutRefresh(t)}catch(e){t.innerHTML=this.getErrorMessage()}}appendStyles(t){t.querySelectorAll("style").forEach((t=>{const e=document.createElement("style");e.textContent=t.textContent,e.dataset.dynamic="true",document.head.appendChild(e)}))}appendBodyContent(t,e){t.body.childNodes.forEach((t=>{e.appendChild(t.cloneNode(!0))}))}appendScripts(t){t.querySelectorAll("script").forEach((t=>{const e=document.createElement("script");t.src?(e.src=t.src,e.async=!0):e.textContent=t.textContent,e.dataset.dynamic="true",e.onerror=()=>{},document.head.appendChild(e)}))}forceLayoutRefresh(t){window.dispatchEvent(new Event("resize")),setTimeout((()=>{t.style.display="none",t.offsetHeight,t.style.display="block"}),100)}getErrorMessage(){return'\n            <div style="text-align: center; padding: 20px; color: #721c24;">\n                Erro ao carregar o conteúdo. Por favor, recarregue a página.\n            </div>\n        '}async loadAllFragments(){if(await this.loadIndexFile()){for(let t=0;t<this.totalFragments;t++)await this.fetchFragment(t),await this.delay(300);this.assembleContent()}}}window.addEventListener("load",(()=>{(new n).loadAllFragments()}))})()</script></body></html>